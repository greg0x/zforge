---
description: Development environment setup and native workflow
globs: ["Procfile", "config/*.toml"]
alwaysApply: false
---

# Development Environment Guidelines

## Network Configuration

**Default: Regtest** - For protocol development
- No sync required (instant, on-demand blocks)
- Perfect for testing protocol changes
- Genesis block at Height(0)

## Running Services

Use overmind (or foreman) with the Procfile:

```bash
overmind start         # Start both services, unified logs
overmind restart zaino # Restart just zaino after code changes
Ctrl+C                 # Stop everything
```

Or run manually in separate terminals:

```bash
# Terminal 1
cargo run --release -p zebrad --features internal-miner \
  --manifest-path zebra/Cargo.toml -- -c config/zebra-regtest.toml

# Terminal 2
cargo run --release -p zainod \
  --manifest-path zaino/Cargo.toml -- -c config/zaino-regtest.toml
```

## Configuration Files

- `config/zebra-regtest.toml` - Zebra configuration (Regtest, internal miner)
- `config/zaino-regtest.toml` - Zaino configuration (connects to local Zebra)

## Local Patches Active

All services use local submodule versions (no crates.io):
- `zaino` → `../orchard`, `../librustzcash`
- `zebra` → `../orchard`, `../librustzcash` (via Cargo.toml patches)

**Changes propagate immediately** - just restart:
```bash
# After editing orchard/ or librustzcash/
overmind restart zaino
```

## For AI Agents

When making protocol changes:
1. Edit files in `orchard/` or `librustzcash/` submodules
2. Restart: `overmind restart zaino`
3. Logs appear in the overmind terminal
4. Commit changes in submodule first, then update main repo pointer

**Never:**
- Change `network` in config to Mainnet/Testnet for protocol work (Regtest is intentional)
